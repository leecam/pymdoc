from .utils import get_keys

from isomdoc import verify_device_response

(issuer_cert_chain, issuer_private_key, device_public_key, device_private_key) = get_keys()
# vp_token = "o2d2ZXJzaW9uYzEuMGlkb2N1bWVudHOBo2dkb2NUeXBldW9yZy5pc28uMTgwMTMuNS4xLm1ETGxpc3N1ZXJTaWduZWSiam5hbWVTcGFjZXOhcW9yZy5pc28uMTgwMTMuNS4xg9gYWFqkaGRpZ2VzdElEGDlmcmFuZG9tUBRjG3eSiYkbYP4H0UNnGN5xZWxlbWVudElkZW50aWZpZXJrZmFtaWx5X25hbWVsZWxlbWVudFZhbHVlak11c3Rlcm1hbm7YGFhTpGhkaWdlc3RJRAhmcmFuZG9tUBWqy2_j2pAa6NWcCxlsy8lxZWxlbWVudElkZW50aWZpZXJqZ2l2ZW5fbmFtZWxlbGVtZW50VmFsdWVlRXJpa2HYGFhPpGhkaWdlc3RJRA1mcmFuZG9tUJwp8ybh8Q18NMhYqN691u5xZWxlbWVudElkZW50aWZpZXJrYWdlX292ZXJfMjFsZWxlbWVudFZhbHVl9Wppc3N1ZXJBdXRohEOhASahGCFZAicwggIjMIIBqaADAgECAhBHb29nbGVfVGVzdF9EU18xMAoGCCqGSM49BAMDMDwxCzAJBgNVBAYTAlVTMQ4wDAYDVQQIEwVVUy1NQTEdMBsGA1UEAwwUR29vZ2xlIFRFU1QgSUFDQSBtREwwHhcNMjMwNzI2MDAwMDAxWhcNMjQxMDI1MDAwMDAxWjA6MQswCQYDVQQGEwJVUzEOMAwGA1UECBMFVVMtTUExGzAZBgNVBAMMEkdvb2dsZSBURVNUIERTIG1ETDBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IABCyAwQv3D2O93MQeog12oi7Loql_qIEb8Z1XJDOxLAwfP5lMBDvn4X3Qg4coG6wMN6UpNhs8s2oPrDjUGsBm-QOjgY4wgYswHwYDVR0jBBgwFoAU3vOrbTfenjqBbhAy0CtIrzWKcaswHQYDVR0OBBYEFDl75TxQ3_DXouSp5GXqc3qe2JLIMA4GA1UdDwEB_wQEAwIHgDAiBgNVHRIEGzAZhhdodHRwczovL3d3dy5nb29nbGUuY29tLzAVBgNVHSUBAf8ECzAJBgcogYxdBQECMAoGCCqGSM49BAMDA2gAMGUCMQCiXNuKbwwjkFudP1gqYI8MFvQ2te7jWH0sqXcWfG8WorneEP4d3RbeBy5Phm8GBacCMGpIiUIfm7N0uL3hdbPWqyMha6l-aJUQl0rg9lmhDpWEabW9gN_BBYiDHZMZgaY5mFkKJtgYWQohpmd2ZXJzaW9uYzEuMG9kaWdlc3RBbGdvcml0aG1nU0hBLTI1Nmdkb2NUeXBldW9yZy5pc28uMTgwMTMuNS4xLm1ETGx2YWx1ZURpZ2VzdHOicW9yZy5pc28uMTgwMTMuNS4xuCwYOVggnhXzX1wl1E_CuQ9F6BO7D_aFXU-rxrCfZqpsENFTysUIWCBRY5hx1YkaPySSgNI1KTZB_3WrRYTVG3qsLSg6h477_AxYIEklDaTi4BNNAOrq9w379FXFEUDjEAirrqcJ2yyoPzC6E1ggDN68iVJ8dXWvIJY0BbmpbqX8c_1OYFH6QwBJU9pBrRUYLVgg8hVLPhGtncJ1-wM37qFtQw5Wp0QqjFnMTdzjN08W1V4YPVgg6Ml0xUTq88kGUQlV6EbnIxQDpVo7Keady0Yz9GJk_skRWCC0HpW6iFOzBPnN4YolnamcrTyCGcp7zAot7kBpR5vk5xgbWCABjZpoB4xTM5ETG_CvPGZoPY-0ySut6S5md3AvXOS0phgiWCB8YJWfLVug6R6ojX7yB7qbNfbmHNzVyMRT1zoRed4c_AdYIOe_gS3A6juDo2WHyr2ddd5yljiHi88BhPNxWnI-X95GGB1YIC0w5-bR-WinN4P1us-156dbRPRjBkyvLZicI9884gWuGDBYIGP3u_QpAq9wJtMsE7BV87PZ3GRExPbp9VKsVptRN-6mA1ggx4cGqR5q2-Ts0HaIGwgjajxYiGJIJHbD7kmu2AbJ4QMUWCCDJ4GGaqg_z-ZyEwrNwMco5sB5jGsj1S-0ExYW3VEGDRgnWCCYRw__Rb8wOkL9JVyClbuYTzp7tBeKnnE4cAaE_eQjSxgzWCCyPJoNAW-dHtJrqrj-83lLE5bGn-w9s_sB6-ocnII5fhgmWCBH-AcZjzCF5NlCqgmFcJOwcKG4Tg1fbCZxHollbNy28gtYIEKYRGX3q59GwHwlqJ9MHLX4qwwCsZTZAFv81ElY5BQ-GCVYIDg-5yM3WyhY9sSwe1f38O0KcdtaJsrpUfVojQQ3LbbyGCxYIPGiCtXC9NG8x9zN1lsQJrmgaZ3JAx4eIMUq-BYSBzRsGDdYIMzmwSfcewdYtox2kFVc4o184t3bAjimlrHALPnuIQ67GBlYIJvqyqtjeddE5Rzx-dNnYL7qq7dw0lIM4aGM7Sn2PtFBBlgg-8MhOqco2BAjxwJI3vc-ffPiK8J9Wh4p74BZ8N3_YNcYI1ggbZeKjrJn2Q9qLkbd9EeSZKauup7dEtmBNegzFzL6L8UYMVggVjIw6yMibkY9pDf-l7LCtuYM797p3j-NiTqGcgm0DbINWCCDegRPLxXkVA7mIONtIyvB9MIBN1hC0u-q9s032F0DIBgoWCBmEwExKO7u7M1En3tWzCwFwM7euwzn5ynAcTZTpPdC7BgqWCC9HrBgdeY3KVmANwx78HrcpRJxVwJFuxhz4iZPU6So3BguWCB_GE4jAgyVwiRaKIRPAAEaD3cYNUN2ge__xZnc4mPeFxg7WCA74QeQxENguNJTpjpkvdRkZ-J4QMZ9KDYVxeIuCns77QBYIGdMjw59ojSUtNwBASZNTxxLVBXHtrVf-5KnGBNOg1swBFggqLwWcpDM3yZMzw8svzYgdKT7MxUp-bnukoT5bkZ7NBEYNFgg5MJqNI_dmezKS4UURcUaUsTR1LOrRJjBoLNzrLQ6Ze8YNlgg7pLTsug20jkPNjo0lx1U5orgFIiwIIxe5TsbMmW99Z4JWCBKfaopAQT59ErX3FwfMGIiJmrTPkThm1eTTEHMoogPsRdYIDY8mZ9wqouQuIEuJFisl2J4KtCflQC7fhTZJktxjUcHGDxYIEm73dnaU3lwuny3WT5iYpsBoWMY2k1rKB8igo6GGi05BVggvtwk6o5Y0IjSO-AGcos4UOQeTswyZKSJz3QDZZcnvW8YGFggnDYyou9CqxAE6zZRwSGTSDT8uKkANXyqk4NN7hVh3MQKWCDCj-nXNmWu5mOAKwOSDuBY90MO7woA1h6IeRcucmHDUA5YIMbXLTYac_FqkDRu6hB_9NYNqbhTOgovIDcpDSghhNFUGCBYIBQu0DuksWN_oIseQrhnWVqKlX37B6d_53_YBYBqs_QsGCRYIC0boyBjeInncavP0hWtBSJUHLrliKUjX0wRWJPaGEoLAVgggEcb8JwIoBN6ASKAh0J74Hlmjdqd3HBP5FF6Z-ZISWd3b3JnLmlzby4xODAxMy41LjEuYWFtdmGzD1ggUuT5PE84NjkswuorlsBaTtRN7gveRd6CPLUlQgIEbGoSWCAe2_TtAo8GviHHean1P-4bVCeB6DpefpiLvyvzpXKfLBg6WCAtJbSLjty-ZyaLiQVgqiEz7LKGx378pfLFnIHomEYVrRgfWCCKkx_KUA8MyUvST8AxXdPVRIEB7mU-p0hLracxMNt5EhgpWCDx18OfEJ1OqiqpmWIAtV7-WiiYySfCxGAzRM1lrNYnbRgcWCAS3M1s7voux4PeqlK_LpwJ_SSa9n5ygES8bcu80IgGXxVYIJfEquF64lNmGSIau0rDo6_-7X2moIOvQ4Y7NUM9HlLJGDVYIDTzHxLaXZVfiP_6gkHHO52bQicQ1zW3axYxMNTKGV0aGBpYIKHaJ9sOSB3iZcalGffTHLdWLFlzAhHtY32xIhyWGQ7TEFgg23C6RTGCG_mn3yT5_imgXM_LHHaKSOwX3IMimnzJtsEYK1ggGiah4yi3M9hCwFLpve_CpTDVVILK6AQlQywFX7DauPIYPlggrKT_xYMzNzD2IwhnYUeWh8Ik_p6PF75Lr1acT-D0_vkYHlggr1MfNOJEa25wydhVzIET-SJczUf4dGQMaGJ2w3yguLQWWCDlqK3oh1hsM5YoY4RAEO3TB9V1sCZ9FvWtiub5EA7kVBg4WCDrgyQwFCPm7Rkskid_-O1u_NeRjqlLOYGY4LYGBBjrVBghWCBxNCtpPPlgOLyC8X03a6wXK61K6m02L46nB3Ib2X2HWBgyWCAI2An8BibVvVfTkxq26WDrb7FeI_RuTpSRVICXDarUBQJYILeiy45XMXiFRQ0Cgm-KWyVNvDk7u1AFKYHNydrBXyf4GC9YIBrCT1zKJQLa2OAgwDCE9_JNjuxRtnqj-NbHsE8vxLUGbWRldmljZUtleUluZm-haWRldmljZUtleaQBAiABIVggZX8fXoYikCEt24HW8UadJ3YeDQ4m1B_77F93v4t7tskiWCCurTOjZoOX6seafyfkAngYlF4m39wzh44IB_P0SWPcmWx2YWxpZGl0eUluZm-jZnNpZ25lZMB4GDIwMjQtMTAtMjRUMTg6MjU6MjkuNzU4Wml2YWxpZEZyb23AeBgyMDI0LTEwLTI0VDE4OjI1OjI5Ljc1OFpqdmFsaWRVbnRpbMB4GDIwMjQtMTEtMjNUMTg6MjU6MjkuNzU4WlhAw051PkWibZbcEM935WO1ZSbWqczOOOguqU-83NDR1rM15p9OK18tK1sg_ze3C2vU3eN6maXcs6m3rnaFuf75XmxkZXZpY2VTaWduZWSiam5hbWVTcGFjZXPYGEGgamRldmljZUF1dGihb2RldmljZVNpZ25hdHVyZYRDoQEmoPZYQKtyD078XiuASRocbBI697k9lEO8cXbev6iyDZyUSwRJI-q7i1AAhubGhl5WYeSUTVtLoXQZb_ZRktkn5A3vbgBmc3RhdHVzAA=="
# device_response = base64.urlsafe_b64decode(vp_token)


verified_device_response = verify_device_response(device_response)
print("verified_device_response {}".format(verified_device_response))

document = verified_device_response.documents[0]
